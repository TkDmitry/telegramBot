= BookMatch Mini App: Техническая и продуктовая документация 

:doctype: book 
:encoding: utf-8 
:lang: ru 
:toc: 
:toclevels: 3 
:toc-title: Содержание 
:icons: font 
:sectnums: 
:source-highlighter: highlightjs 
:sectanchors: 
:imagesdir: images 
:experimental:

== Введение
BookMatch Mini App — это мобильное приложение нового поколения для любителей чтения, которое объединяет книжный клуб, систему интеллектуального подбора собеседников и соционическое типирование. Приложение находится на стыке социальных сетей, рекомендательных сервисов и современных психологических подходов, что позволяет создавать уникальные социальные и интеллектуальные связи между пользователями. +
Данная документация описывает ключевые модули приложения, их архитектуру, пользовательские сценарии и бизнес-логику, а также раскрывает детали технической реализации, UX/UI-особенности, стратегии монетизации и план запуска продукта на рынок. Документ структурирован в формате AsciiDoc и содержит схемы на Mermaid для ER-диаграмм, flowchart’ов и wireframe’ов.

== 1. Архитектура приложения (общая)

BookMatch Mini App реализует мульти-модульную архитектуру с четким разделением ответственности между компонентами, соблюдая принципы SOLID/KISS/DRY для устойчивости и масштабируемости, а также трехслойную архитектуру: Presentation/UI, Domain/Business Logic, Data/Persistence. Клиент и сервер взаимодействуют через REST API и WebSocket для real-time-коммуникаций.

[mermaid, architecture_overview, svg]

----

flowchart LR 
subgraph MobileApp 
UserInterface --> DomainLogic 
DomainLogic --> DataLayer 
end 
DataLayer <-->|REST/WebSocket| BackendAPI 
BackendAPI -->|ORM| DB[(PostgreSQL)] 
BackendAPI --> SocionicsService 
BackendAPI --> RecommendationService 
BackendAPI --> ChatService 
BackendAPI <--> NotificationService 
BackendAPI <--> AnalyticsService 
BackendAPI -.- PaymentGateway 
BackendAPI -.- BookDB[(Books Repository)] 
UserInterface -.-> Notifications 
UserInterface -.-> PushNotifications

----

В рамках такой архитектуры обеспечивается логическая и физическая независимость слоев, что ускоряет процесс разработки и последующего обслуживания проекта.

== 2. Модуль «Профиль пользователя»

=== Функциональность

Регистрация через e-mail, номер телефона или соцсети (OAuth 2.0).
Персональные данные: имя, аватар, пол, возраст, город, профессия, интересы, о себе.
Соционический тип (результат теста или ручной ввод).
Читательская идентичность: любимые жанры, избранные авторы, книжные достижения, текущие и прочитанные книги.
Настройки приватности (что и кому показывать).
Статистика: активность, участие в клубах, рейтинг, прогресс чтения.
Достижения, бэджи, геймификация.
История взаимодействий: друзья, подписки, лайки, сообщения.

=== Архитектура

Каждый профиль представлен как обогащенная сутью User, расширяемая атрибутами через связанную коллекцию (Profile, BookPreferences, SocionicsProfile, Achievements).

[mermaid, er_profile, svg]

----
erDiagram 
USER ||--o{ PROFILE : has USER ||--|{ FRIENDSHIP : "friend" USER ||--o{ SOCIONICS_RESULT : "has" PROFILE ||--o{ BOOK_PREFERENCE : "likes" PROFILE ||--o{ ACHIEVEMENT : "unlocks" BOOK_PREFERENCE }o--|| BOOK : "refers to" FRIENDSHIP { int id PK int user_id FK int friend_id FK string status } PROFILE { int id PK int user_id FK string bio string avatar_url date birthday string city string occupation bool is_public } SOCIONICS_RESULT { int id PK int user_id FK string socionics_type date test_date string test_method bool verified } BOOK_PREFERENCE { int id PK int profile_id FK int book_id FK string genre int rating }
----

=== Пользовательские сценарии

. Быстрая регистрация с соцсетями, заполнение базовых данных. . Прохождение соционического теста (опционально). . Импорт книжной полки из сторонних сервисов (MyBook, ЛитРес, др.). . Персонализация приватности. . Просмотр достижений и статуса. . Изменение настроек и выход из аккаунта.

=== Бизнес-логика

Только владелец профиля может редактировать свои данные, за исключением типа верифицированного социониковедом.
Некоторые показатели (статистика, достижения) могут быть скрыты.
Сводка активности формируется для анализа вовлеченности.

=== UX/UI

Минимализм, быстрый доступ к основным параметрам.
Дружественная анимация наград и достижений для поддержания интереса.
Ярко выраженная кнопка для редактирования профиля.
Соционический тип, если верифицирован, выделяется специальным бэйджем.

[mermaid, wireframe_profile, svg]

flowchart TD A[Профиль] --> B[Аватар, имя, тип] A --> C[Короткая биография] A --> D[Книжная полка] A --> E[Достижения/бейджи] A --> F[Соционика] F --> G[Тип, пройденный тест, верификация] A --> H[Статистика] A --> I[Настройки]

== 3. Система подбора собеседников

=== Функциональность

Алгоритмы интеллектуального мэтчинга по соционике, интересам, книжным вкусам и поведению.
Мгновенный сбор шорт-листа "Потенциальных собеседников" на основе compatibility-score.
Фильтры (по городу, возрасту, полу, доступности для чата, жанровым интересам, типу).
Альтернатива Tinder-like свайперу: листание карточек, лайк/скип/суперлайк.
Smart-обучение: коррекция совместимости на основании реальных взаимодействий (переписка, отзывы, встречи).

=== Алгоритмы

Базируется на гибридной модели:
Алгоритм Гейла-Шэпли (stable matching) для поиска устойчивых пар по взаимному интересу и соционическим типам2.
Поведенческая координация: анализ лайков, времени отклика, тематик разговоров.
Параметры-исключения и индивидуальные критерии (черные списки, предпочтения).
Машинное обучение для персонализации (history-aware recommendation).

=== Архитектура

[mermaid, er_matching, svg]
----
erDiagram USER ||--o{ MATCH_REQUEST : "initiates" USER ||--o{ MATCH_RESULT : "matched" MATCH_REQUEST { int id PK int user_id FK int candidate_id FK string status float socionics_score float interest_score date request_date } MATCH_RESULT { int id PK int user1_id FK int user2_id FK date match_date float compatibility bool is_active } SOCIONICS_RESULT ||--o{ MATCH_RESULT : "used by"
----

=== Пользовательские сценарии

. Поиск собеседников вручную или с помощью свайп-ленты. . Внесение предпочтений и ограничений. . Ожидание встречной реакции — матч случается только при взаимном интересе. . Возможность отметить лучших совпавших и негативный опыт. . Запуск диалога (открытие чата).

=== Бизнес-логика

Пользователь не может отправить более 10 новых запросов в сутки (антиспам).
При изменении соционического типа пересчитываются шансы совпадений.
Имеется просмотр статистики "вы понравились, но не ответили".
Система запоминает параметры успешных мэтчей и учится оптимизировать выдачу.

=== UX/UI

Свайпер с карточками профиля, дружелюбные анимации для лайка/скипа.
Ярко выделены ключевые совпадения (социальный и соционический бейдж).
Фильтры и сортировка доступны из основного экрана.
Push-уведомления о новых совпадениях и проявленном интересе.

[mermaid, wireframe_matching, svg]

----

flowchart TD 
A[Лента совпадений] --> B[Карточка пользователя] 
B --> C[Кнопки: лайк/скип/детали профиля] 
A --> D[Фильтрация] 
D --> E[Параметры поиска] 
A --> F[Рекомендации] 
F --> G[Совместимость: % + бейдж]

----

== 4. Книжное комьюнити

=== Функциональность
Виртуальный книжный клуб с регулярными тематическими встречами и обсуждениями, чатами, опросами.
User-generated content: блоги, рецензии, рейтинги, коллекции книжных подборок.
Возможность создавать и вступать в микрокомьюнити по жанрам, авторам, городским книжным кружкам.
Общая книжная полка, персональные и коллективные челленджи (на месяц, год).
Система цитат (сбор и обмен), публикация цитат и заметок.
Голосования за новые клубные книги.

=== Архитектура

[mermaid, er_bookcommunity, svg]

----

erDiagram 
USER ||--o{ CLUB : "member" 
CLUB ||--o{ EVENT : "organizes" 
EVENT ||--o{ DISCUSSION : "initiates" 
USER ||--o{ REVIEW : "writes" 
BOOK ||--o{ REVIEW : "receives" 
USER ||--o{ COMMENT : "writes" 
BOOK ||--o{ QUOTE : "has" 
USER ||--o{ QUOTE : "collects" 
BOOK ||--|{ BOOK_CLUB : "in" 
CLUB { int id PK string name text description string genre string city int owner_id FK } 
EVENT { int id PK int club_id FK string title date event_date } 
DISCUSSION { int id PK int event_id FK string topic } 
REVIEW { int id PK int user_id FK int book_id FK text content int rating date review_date } 
QUOTE { int id PK int book_id FK int user_id FK text content string page_ref }

----

=== Пользовательские сценарии

. Вступление в комьюнити/клуб, участие в голосовании. . Создание собственного книжного клуба по интересам. . Публикация рецензии, лайк/дислайк обзоров. . Организация ивента — онлайн/оффлайн. . Просмотр топ-цитат месяца. . Участие в групповом марафоне (например, "12 книг в год").

=== Бизнес-логика

Лимит личных клубов на одного пользователя — 3.
Достижения и рейтинг клубов формируются по активности и вовлеченности.
Голосования могут завершаться предложением следующей клубной книги.
Антиспам-фильтры на контент и жалобы.

=== UX/UI

Вкладки "Клубы", "Обсуждения", "Марафоны".
Крупные обложки книг, адаптивная галерея цитат.
Виньетки для членов клуба, эмодзи для рецензий.
Интеграция карт для офлайн-ивентов.

[mermaid, wireframe_community, svg]


----

flowchart TD 

A[Главная BookMatch Community] --> B[Список клубов] 
A --> C[Марафоны] 
A --> D[Популярные книги/рецензии] 
B --> E[Клуб: Лента/Участники/Чаты/События] 
D --> F[Рецензии: обзор, лайки] 
C --> G[Текущий челлендж]

----

== 5. Соционический модуль

=== Функциональность

Встроенный адаптивный соционический тест на базе классических (по Аушре, Гуленко) и многофакторных опросников5.
Тестирование на тип, дополнительные параметры (квадра, древо Рейнина).
Краткие и полные описания соционических типов для образовательных целей.
Верификация типа чек-листом или экспертной консультацией.
Открытое и закрытое отображение типа в профиле.
Расчет совместимости с другими типами и рекомендации для коммуникации.

=== Архитектура

[mermaid, er_socionics, svg]

----

erDiagram 
USER ||--o{ SOCIONICS_RESULT : "has" SOCIONICS_RESULT { int id PK int user_id FK string socionics_type date test_date string method float confidence bool verified } SOCIONICS_COMPATIBILITY { int id PK int type_a int type_b float compatibility_score string description } SOCIONICS_TYPE { string code PK string label string description string strengths string weaknesses }

----

=== Пользовательские сценарии

. Сдача теста при первом входе или позже. . Получение краткого психологического профиля, рекомендации. . Поиск "дуалов" для общения, известные примеры (фильмы/литература). . Заказ платной экспертной верификации (опционально).

=== Бизнес-логика

Результат теста влияет на алгоритмы мэтчинга.
Возможна единожды бесплатная попытка верификации типа.
При смене ответов возможно повторное прохождение за плату.
Тип скрыт от других пользователей по умолчанию, если не верифицирован или не включен в настройках приватности.

=== UX/UI

Прогресс-бар и геймификация в процессе теста.
Визуализация вашего типа в цветовой схеме (например, квадры).
Справочник с быстрым поиском по типам.
Советы по общению.

[mermaid, wireframe_socionics, svg]

----

flowchart TD 
A[Модуль соционики] --> B[Тестирование] 
A --> C[Профиль типа] 
A --> D[История прохождения тестов] 
A --> E[Экспертная верификация] 
C --> F[Совместимость с другими типами] 
E --> G[Запрос/ответ эксперта]

----

== 6. Чат-система

=== Функциональность

Персональные чаты 1-1 и групповые (до 20 человек).
Отправка текстовых сообщений, медиа (фото, видео, цитаты из книг).
Встроенная интеграция ссылок на книги, рецензии и цитаты.
Push-уведомления о новых сообщениях.
Возможность начать чат только после взаимного мэтча.
Система антиспама, жалобы, блокировки.
Голосовые сообщения (опционально).

=== Архитектура

В чате используется WebSocket для обмена данными в реальном времени (Node.js/Socket.IO backend, PostgreSQL/Redis для хранения сообщений).

[mermaid, er_chat, svg]

----

erDiagram 
USER ||--o{ CHAT : "participant" CHAT ||--o{ MESSAGE : "contains" CHAT { int id PK string title bool is_group int owner_id FK date created_at } MESSAGE { int id PK int chat_id FK int sender_id FK text content string type date sent_at bool is_read string media_url } USER ||--o{ MESSAGE : "sends"

----

=== Пользовательские сценарии

. Уведомление о новом мэтче — переход в диалог напрямую. . Групповой чат клуба — обсуждение, голосования, опросы. . Пересылка понравившейся цитаты или книги собеседнику. . Жалоба на нежелательное общение.

=== Бизнес-логика

Новый диалог доступен только после взаимного интереса (мэтча).
Сообщения хранятся до удаления пользователем или автоочистки через 90 дней неактивности.
Возможность закреплять сообщения/рекомендации.
Push-уведомления на новые, непрочитанные сообщения.

=== UX/UI

Похожие на мессенджеры Telegram/WhatsApp: список чатов, превью последних сообщений.
Аватарки, цветовое кодирование новых сообщений.
Быстрая навигация к связанным объектам (книга, клуб, профиль).
Опциональная темная тема.

[mermaid, wireframe_chat, svg]

----

flowchart TD 
A[Список чатов] --> B[Обычные диалоги] 
A --> C[Групповые чаты] 
B --> D[Экран переписки] 
C --> E[Обсуждение клуба]
D --> G[Отправить цитату/книгу] 
D --> F[Кнопка закрепть/жалоба] 
----



== 7. Frontend реализация

=== Стек технологий

React Native — кроссплатформенная основа для Android и iOS8.
Redux для управления состоянием.
TypeScript для строгой типизации.
WebSocket (socket.io-client) — real-time обмен событиями.
RESTful API (axios/fetch).
Использование UI-библиотек (например, Material UI или Chakra UI для RN).
Push-уведомления — Firebase Cloud Messaging (Android), Apple Push Notification Service (iOS).

=== Архитектура слоев

Presentation Layer: React Components (экраны, вайрфреймы, формы).
State Layer: Redux, Thunk для асинхронных действий.
Networking Layer: API-клиенты (auth, user, match, book, chat).
Utils: хелперы, конвертеры моделей.

=== Особенности реализации

. Вся навигация реализована через стек- и таб-навигаторы. . Экраны: Профиль, Навигатор совпадений, Клубы, Модуль соционики, Чаты, Настройки. . Использование автообновляемых flatlist для лент. . Поддержка темной/светлой темы, плавные анимации. . Ленивая загрузка heavy-ресурсов (изображения, pull-to-refresh).

=== UX/UI решения

. Контрастный дизайн, крупные кликабельные области. . Понятные иконки, расширенная доступность (размер шрифта, цветовой контраст). . F-образный паттерн размещения, минимализм, яркие акценты для ключевых действий. . Onboarding с визуальными подсказками.

== 8. Backend реализация

=== Стек технологий

База: Node.js  / Express.js  (или FastAPI при необходимости Python-экосистемы).
СУБД: PostgreSQL (данные пользователей, книжная база), Redis (кеширование, уведомления, очередь событий).
WebSocket (socket.io) для чатов.
Модуль соционики — отдельный сервис (Python/Flask или FastAPI), реализующий тест и расчет совместимости.
Хранилище файлов: Amazon S3 / Cloud Storage.
Оповещения: Push (через Firebase, APNS).
Мониторинг/логирование: Sentry, Prometheus.

=== Архитектура

[mermaid, flow_backend, svg]

flowchart TD A[Mobile App] -->|REST/WebSockets| B[API Gateway] B --> C[User Service] B --> D[Matchmaking Service] B --> E[Socionics Service] B --> F[Book Community Service] B --> G[Chat Service] C --> DB[(Postgres)] G --> REDIS[(Redis)] E --> H[Socionics DB] F --> I[Book Storage] B --> J[Notification Service] J --> K[Push/Email] M[Admin Dashboard] --> B

=== REST API (кратко)

/api/v1/auth — авторизация, регистрация.
/api/v1/users — профиль.
/api/v1/match — система подбора.
/api/v1/books — книга, отзывы, цитаты.
/api/v1/clubs — книжные клубы.
/api/v1/socionics — соционический тест, результат, совместимость.
/api/v1/chat — переписка.
/api/v1/notifications.

=== Безопасность и масштабирование

JWT токены, refresh токены для авторизации.
Rate limiting.
Масштабирование по микросервисам.
PostgreSQL — мастер/реплика для плавного масштабирования.
Redis Pub/Sub — real-time события (чаты, уведомления).

== 9. UX/UI особенности

=== Ключевые принципы

Мобильность — все критичные действия в 1-2 тапа.
Адаптивность — поддержка разных размеров экранов, soft-клавиатур.
Минимализм, крупные кнопки, понятные подписи.
Осознанный онбординг: короткие подсказки, визуальные примеры функциональности.
Сбалансировано между стандартными паттернами и ноткой индивидуальности1214.

=== Навигация

Bottom tab navigation: Домой, Клубы, Мэтчинг, Соционика, Настройки.
Логичное разделение функциональности по вкладкам.
Быстрый возврат к основному действию (FAB, Back action).

=== Визуальная иерархия

Яркие action-кнопки, крупные заголовки.
Белое пространство, разделение зон.
Цветовая кодировка статусов (например, высокий % совместимости).

=== Персонализация

Темы (светлая, темная, индивидуальная).
Геолокационные предложения книжных клубов.
Онбординг с учетом предпочтений после регистрации.

=== Адаптивность и отзывчивость

Использование flexbox-верстки.
Тестирование на различных устройствах.

=== Геймификация

Бейджи, лидерборды, прогресс-бары для челенджей.
Мини-игры: угадай жанр по цитате.

=== Доступность

Высокий контраст.
Поддержка VoiceOver, TalkBack.
Альтернативные тексты для иконок.

== 10. Монетизация

=== Актуальные модели для BookMatch

Freemium: базовый доступ бесплатный, дополнительные плюшки (расширенные фильтры мэтчинга, экспертиза по соционике, эксклюзивный контент клубов) по подписке17.
Подписка: ежемесячная, годовая; вариации — "Premium", "Club VIP", "Socionics Pro".
Paywall для эксклюзивных клубных ивентов (ограниченные лекции, онлайн-интервью с авторами).
Внутриприложенные покупки: подарки, тематические мини-игры, extra-суперлайки, анонимные отзывы.
Реклама: ненавязчивые баннеры в ленте, отключаемые подпиской или при достижении порога активности.
Партнерские программы с книжными магазинами (скидки через партнерскую ссылку).

=== Ограничения и условия

Монетизация активируется при достижении ретеншн-метрики Day 7 Retention > 30%.
Бесплатный trial – 7 дней премиум-функций.
Бонусы за invite друзей.
Скидки и временные акции.

=== Anti-patterns

Нельзя навязывать подписку до демонстрации реальной пользы.
Ограничение в базовом функционале не мешает критическим юзер-сторис (нет блокировки мэтчинга или чатов для бесплатных пользователей).

== 11. План запуска

=== Предзапуск (Pre-Launch, 1-2 месяца)

. Формулирование уникального ценностного предложения (Unique Value Proposition)20. . Анализ рынка: оценка конкурентов (Tinder, Twinby, Meetch, Whattoread, соцсети книжников, Bookmate и др.); SWOT-анализ. . Определение целевой аудитории: портреты, проблемы, паттерны. . Тестирование идеи на фокус-группах; A/B-тесты вайрфреймов. . Создание промо-лендинга и предварительной базы бета-юзеров. . Медиа-поддержка: связка соцсетей, тематических форумов, лидеров мнений. . Разработка MVP (минимально жизнеспособного продукта). . Настройка аналитики (Mixpanel, Firebase, Amplitude). . Подготовка технической инфраструктуры (DevOps, CI/CD, мониторинг).

[mermaid, flow_launch, svg]

----
flowchart TD 
A[Аналитика и подготовка] --> B[Создание MVP] 
B --> C[Внутренний тест] 
C --> D[Загрузка в closed beta] 
D --> E[Сбор обратной связи] 
E --> F[Правки, доработка] 
F --> G[Pre-launch маркетинг] 
G --> H[Открытие публичной беты] 
H --> I[Публичный релиз]
----

=== Пилот и публичная бета (2 месяца)

Invite-only бета для early adopters.
Сбор отзывов, фиксация багов, итеративная доработка.
Просмотр метрик: DAU, Retention, Conversion.
Сообщества внутри приложения/telegram-канал для обратной связи.
Поддержка расширенного функционала.

=== Релиз (Launch Day onwards)

Открытый релиз в App Store, Google Play, RuStore (при необходимости).
Стартовая промо-акция (bonuses, trial подписка).
Партнерские публикации, инфлюенсеры, опросы, запуск клубных марафонов.
SMM + ASO (App Store Optimization).

=== Пост-релизная поддержка

Быстрые фиксы багов.
Внедрение новых фичей по результатам опросов.
Сбор статистики, донастройка воронки активации и монетизации.
Дополнительные рекламные кампании.
Постоянная коммуникация с аудиторией.

== 12. AsciiDoc и Mermaid: рекомендации по оформлению

Все ключевые разделы оформляются в виде AsciiDoc с многоуровневыми заголовками (=, ==, ===).
Диаграммы (ERD, flowcharts, wireframes) интегрируются через блоки:

[source,asciidoc]

[mermaid, id, svg]

mermaid code

При необходимости использовать аннотированные списки для задач и шагов.
Для архитектурных схем и ERD — явно описывать отношения (см. выше).
Для пользовательских сценариев предпочтительнее пошаговый формат.
Все визуальные элементы должны быть подписаны и структурированы по смыслу.
Для технических спецификаций использовать нумерованные и маркированные списки, таблицы.
Документ поддерживает экспорт в HTML, PDF и другие форматы через Asciidoctor.

== 13. Примеры AsciiDoc-оформления и шаблонов

[source,asciidoc]

== Пример блока кода

[source,typescript]

interface IBook 
{ id: string; title: string; author: string; genre: string; description?: string; }

== Пример таблицы

[cols="1,3,2", options="header"] 

|=== 
|Тип монетизации |Описание |Применимость в BookMatch
|Freemium |Базовые функции бесплатно, доп. — по подписке |Да |Подписка |Регулярная ежемесячная/годовая оплата |Да |Платный доступ |Разовый платеж за весь функционал |Нет (нишевые фичи) |Реклама |Доход от показов в бесплатной версии |Возможно |In-app покупки |Покупка отдельных функций/подарков |Да 
|===

== Пример внедрения Mermaid-диаграммы

[mermaid, sample_er, svg]

----

erDiagram 
BOOK ||--o{ REVIEW : receives USER ||--o{ REVIEW : writes REVIEW { int id PK int user_id FK int book_id FK text content int rating date written_at }
----

== 14. Заключение

BookMatch Mini App — это не просто "мобильное приложение для чтения", а комплексная социальная экосистема, где объединены лучшие практики знакомств, книжного клубного общения, соционического анализа и лайфстайл-геймификации. +
Техническая и продуктовая архитектура подобрана таким образом, чтобы минимизировать барьеры для вовлечения, обеспечить высокий retention, персонализированную ценность для пользователя и прозрачный путь монетизации проекта. +
Только продуманное проектирование модулей, современный дизайн и работающая стратегия запуска открывают шанс занять заметное и устойчивое место на насыщенном рынке книжных и образовательных мини-приложений. +